chrome.runtime.onMessage.addListener(async(l,d,n)=>{if(l.action==="getKindleHighlight"){const e=document.querySelector("#annotation-scroller > div > div.a-row.a-spacing-base > div.a-column.a-span5 > h3"),t=document.querySelector("#annotation-scroller > div > div.a-row.a-spacing-base.kp-notebook-row-separator > div.a-column.a-span9.a-span-last > div:nth-child(3) > span"),o=document.querySelectorAll("#highlight.a-size-base-plus.a-color-base"),i=document.querySelectorAll("#note.a-size-base-plus.a-color-base");if(o.length===0)return console.log("ハイライトが存在しません"),n({success:!1,bookDetails:[]}),!1;const c=Array.from(o).map((u,h)=>{var s,r;const a=i[h];return{highlight:((s=u.textContent)==null?void 0:s.trim())||"",note:a&&((r=a.textContent)==null?void 0:r.trim())||""}});return n({success:!0,title:(e==null?void 0:e.textContent)||"",bookAuthor:(t==null?void 0:t.textContent)||"",bookDetails:c}),!0}});
